meta:
  author: "Antigravity"
  description: "Scanner Detection Tests"
  enabled: true
  name: "913-scanner-detection"
tests:
  - test_id: 913100
    desc: "User-Agent: Nikto"
    stages:
      - stage:
          input:
            dest_addr: "127.0.0.1"
            method: "GET"
            port: 80
            headers:
              User-Agent: "Nikto"
              Host: "localhost"
            uri: "/"
          output:
            log_contains: "id \"913"
  - test_id: 913101
    desc: "User-Agent: Nessus"
    stages:
      - stage:
          input:
            dest_addr: "127.0.0.1"
            method: "GET"
            port: 80
            headers:
              User-Agent: "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; InfoPath.2; MS-RTC LM 8; Nessus)"
              Host: "localhost"
            uri: "/"
          output:
            log_contains: "id \"913"
  - test_id: 913102
    desc: "User-Agent: OpenVAS"
    stages:
      - stage:
          input:
            dest_addr: "127.0.0.1"
            method: "GET"
            port: 80
            headers:
              User-Agent: "OpenVAS"
              Host: "localhost"
            uri: "/"
          output:
            log_contains: "id \"913"
  - test_id: 913103
    desc: "User-Agent: Nmap Scripting Engine"
    stages:
      - stage:
          input:
            dest_addr: "127.0.0.1"
            method: "GET"
            port: 80
            headers:
              User-Agent: "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)"
              Host: "localhost"
            uri: "/"
          output:
            log_contains: "id \"913"
  - test_id: 913104
    desc: "Header: Acunetix-Aspect"
    stages:
      - stage:
          input:
            dest_addr: "127.0.0.1"
            method: "GET"
            port: 80
            headers:
              User-Agent: "Mozilla/5.0"
              Host: "localhost"
              Acunetix-Aspect: "enabled"
            uri: "/"
          output:
            log_contains: "id \"913"
  - test_id: 913105
    desc: "Header: X-Scanner"
    stages:
      - stage:
          input:
            dest_addr: "127.0.0.1"
            method: "GET"
            port: 80
            headers:
              User-Agent: "Mozilla/5.0"
              Host: "localhost"
              X-Scanner: "Burp"
            uri: "/"
          output:
            log_contains: "id \"913"
